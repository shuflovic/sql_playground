[
    {
        "name": "select all (flights)",
        "sql": "select*from flights"
    },
    {
        "name": "add a row to workaway",
        "sql": "insert into workaway_projects (country,location,nights,name)\nvalues ('peru','yuihau','14','alvaro')"
    },
    {
        "name": "select all (workaway)",
        "sql": "select*from workaway_projects"
    },
    {
        "name": "sum price in flights",
        "sql": "select sum(price)from flights"
    },
    {
        "name": "country by nights",
        "sql": "select sum(nights/person*2),country from data\ngroup by country\norder by sum(nights/person*2) desc"
    },
    {
        "name": "create procedure get all flights",
        "sql": "create procedure getallflights\nas\nbegin\nselect*from flights\nend"
    },
    {
        "name": "get all flights P",
        "sql": "getallflights"
    },
    {
        "name": "select all data",
        "sql": "select * from data"
    },
    {
        "name": "select only counties",
        "sql": "SELECT country \nFROM data \nGROUP BY country \nORDER BY MIN(id) ASC"
    },
    {
        "name": "add a column with 123",
        "sql": "SELECT \n    ROW_NUMBER() OVER (ORDER BY MIN(id)) AS ID, \n    country\nFROM data\nGROUP BY country\nORDER BY MIN(id) ASC"
    },
    {
        "name": "simple update nights",
        "sql": "UPDATE data\nSET nights = 0\nWHERE id = 27;"
    },
    {
        "name": "country f",
        "sql": "SELECT \n    country,\n    CAST(SUM((CAST(nights AS FLOAT) / 2.0) * person) AS INT) AS nights\nFROM data \nGROUP BY country \nORDER BY MIN(id) ASC"
    },
    {
        "name": "avg price per night",
        "sql": "SELECT \n    country,\n    CAST(SUM((CAST(ISNULL(nights, 0) AS FLOAT) / 2.0) * ISNULL(person, 0)) AS INT) AS nights,\n    SUM(ISNULL(total_price_of_stay, 0)) AS total_price,\n    CAST(\n        SUM(ISNULL(total_price_of_stay, 0)) / \n        NULLIF(SUM((CAST(ISNULL(nights, 0) AS FLOAT) / 2.0) *2* ISNULL(person, 0)), 0) \n    AS DECIMAL(10,2)) AS avg_price_per_night\nFROM data \nGROUP BY country \nORDER BY MIN(id) ASC;"
    },
    {
        "name": "paid nights",
        "sql": "SELECT \n    country,\n    -- Total Nights (All)\n    CAST(SUM((CAST(ISNULL(nights, 0) AS FLOAT) / 2.0) * ISNULL(person, 0)) AS INT) AS nights,\n    \n    -- Paid Nights (Only where price > 0)\n    CAST(SUM(\n        CASE \n            WHEN ISNULL(total_price_of_stay, 0) > 0 \n            THEN (CAST(ISNULL(nights, 0) AS FLOAT) / 2.0) * ISNULL(person, 0)\n            ELSE 0 \n        END\n    ) AS INT) AS paid_nights,\n    \n    -- Total Price\n    SUM(ISNULL(total_price_of_stay, 0)) AS total_price,\n    \n    -- Average per Paid Night (Force 0.00 instead of NULL)\n    ISNULL(\n        CAST(\n            SUM(ISNULL(total_price_of_stay, 0)) / \n            NULLIF(SUM(CASE WHEN ISNULL(total_price_of_stay, 0) > 0 THEN (CAST(ISNULL(nights, 0) AS FLOAT) / 2.0) *2* ISNULL(person, 0) ELSE 0 END), 0) \n        AS DECIMAL(10,2)), \n    0) AS avg_per_paid_night\n\nFROM data \nGROUP BY country \nORDER BY MIN(id) ASC;"
    },
    {
        "name": "select all average table",
        "sql": "select * from average"
    },
    {
        "name": "rename table",
        "sql": "sp_rename 'average2','average'"
    },
    {
        "name": "add avg per person in average",
        "sql": "alter table average\nadd avg_nights as\ncast(total_price/2/paid_nights as decimal(10,2))"
    }
]